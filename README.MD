# Library
Проект пердставляет собой http-server на базе Koa

### Подготовка
Перед использованием заполните настройки базы данных MySQL и хост\порт приложения в файле config/default.json
### Установка
Для установки зависимостей запустите в консоли команду:
```
npm i
```
Для создания базы данных mysql и заполнения её тестовыми данными выполните команду:
```
npm run prepare
```
### Запуск
Для запуска проекта выполните команду:
```
npm start
```

### Использование
Апи включает в себя 6 роутов:
```
GET /author
POST /author
PATCH /author/:id
GET /book
POST /book
PATCH /book/:id
```
### GET
Общие параметры запросов
* limit - количество записей,
* offset - смещение
* order[```field```]=[```sort```], где
  - ```field``` является полем сортировки
  - ```sort``` порядком (asc либо desc)

#### /author
Возвращает список авторов.

Список фильтров
* id[```op```]
  - в качестве ```op``` могут выступать операции __eq__, __gt__, __gte__, __lt__, __lte__, наприме ```id[gte]=5``` вернёт записи с id большим либо равным 5
* firstname[```op```]
  - в качестве ```op``` может приниматься операция like, значение соответствует sql-синтаксису(т.е. включает символы '%' и '_')
* lastname[```op```]
  - в качестве ```op``` может приниматься операция like, значение соответствует sql-синтаксису(т.е. включает символы '%' и '_')

#### /book
Возвращает список книг.

Список фильтров
* id[```op```]
  - в качестве ```op``` могут выступать операции __eq__, __gt__, __gte__, __lt__, __lte__, наприме ```id[gte]=5``` вернёт записи с id большим либо равным 5
* author_id[```op```]
  - в качестве ```op``` могут выступать операции __eq__, __gt__, __gte__, __lt__, __lte__
* date[```op```]
 - в качестве ```op``` могут выступать операции __eq__, __gt__, __gte__, __lt__, __lte__, формат даты __YYYY-MM-DD__
* title[```op```]
  - в качестве ```op``` может приниматься операция like, значение соответствует sql-синтаксису(т.е. включает символы '%' и '_')
* description[```op```]
  - в качестве ```op``` может приниматься операция like, значение соответствует sql-синтаксису(т.е. включает символы '%' и '_')

#### Пример
```
/book?limit=20&id[gte]=5&title[like]=%world%&order[id]=desc
```
вернёт до 20 записей с id больше либо равным 5, заголовком содержащим строку world и отсортированные по убыванию id.
### POST

```Content-Type multipart/form-data```

#### /author
Добавляет запись о авторе, в случае успеха возвращает id добавленой записи, иначе - 0.

Поля:
* firstname
* lastname

#### /book
Добавляет запись о книге, в случае успеха возвращает id добавленой записи, иначе - 0.

Поля:
* title - название книги
* date - дата выпуска, в формате 'YYYY-MM-DD' 
* description - описание книги
* author_id - id автора
* image - файл изображения обложки

### PATCH

```Content-Type multipart/form-data```

#### /author
Изменяет запись о авторе, в случае успеха возвращает 1, иначе - 0.

Поля:
* firstname
* lastname

#### /book
Изменяет запись о книге, в случае успеха возвращает 1, иначе - 0.

Поля:
* title - название книги
* date - дата выпуска, в формате 'YYYY-MM-DD' 
* description - описание книги
* author_id - id автора
* image - файл изображения обложки

